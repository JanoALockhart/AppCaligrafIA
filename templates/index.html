<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Calligraphy Recommendation Prototype</title>
    <style>
        .row-container {
            border: 1px solid #ccc;
            padding: 6px;
            margin: 6px 0;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .row-image {
            max-height: 80px;
            border: 1px solid #aaa;
        }
        .accuracy {
            font-family: sans-serif;
        }

        #image-preview {
            width: 300px;      /* fixed width */
            height: auto;      /* keep aspect ratio */
            border: 1px solid #ccc;
            display: none;
            margin-top: 10px;
        }
    </style>
</head>
<body>

    <h1>Calligraphy Analyzer</h1>

    <form method="POST" action="{{ url_for('analyse') }}" enctype="multipart/form-data">
        <label for="model">Select model:</label>
        <select id="model" name="model">
            {% for m in models %}
            <option value="{{ m.id }}">{{ m.name }}</option>
            {% endfor %}
        </select>

        <br><br>

        <label for="image">Upload image:</label>
        <input type="file" id="image" name="image" accept="image/*" onchange="previewImage(event)">
        <br><br>
        <button type="submit">Analyze</button>

        <img id="image-preview">

        <br><br>

        
    </form>

    <hr>

    {% if rows %}
    <h2>Extracted Rows</h2>

    {% for i in range(26) %}
    <div class="row-container">
        <div>
            <strong>{{ letters[i] }}</strong>
        </div>

        {% if rows[i] %}
        <img class="row-image" src="{{ rows[i] }}" alt="Row {{ i }}">
        {% else %}
        <div>No image</div>
        {% endif %}

        <div class="accuracy">
            Accuracy: {{ accuracies[i] }}%
        </div>
    </div>
    {% endfor %}

    {% endif %}


<script>
    function previewImage(event) {
        const file = event.target.files[0];
        if (!file) return;

        const preview = document.getElementById('image-preview');
        preview.src = URL.createObjectURL(file);
        preview.style.display = 'block';
    }
</script>
</body>
</html>
